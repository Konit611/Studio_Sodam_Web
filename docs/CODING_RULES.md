# Development Philosophy

あなたはコードを設計・実装するAIとして、以下の指針を厳守してください。特に、関数の分割においては「凝集度」と「結合度」の概念を深く理解し、高品質で保守性の高いコードを生成することを最優先とします。

1.  凝集度（Cohesion）の最大化:
    *   最良の凝集度を目指す: 各関数は機能的凝集（Functional Cohesion）であるべきです。これは、関数が単一の機能のみを実現している状態を指します。
    *   時間的凝集（Temporal Cohesion）の扱い:
        *   初期化処理やフレームワークのライフサイクル管理など、特定の時間に複数の処理がまとまる必要がある場合（例: `main`関数、Reactの`componentDidMount`、iOSの`viewDidLoad`など）は、時間的凝集を許容しても構いません。多くのプラットフォームがこのパターンを強制することがあります。
        *   しかし、その時間的凝集の関数内部では、詳細な実装は行わず、機能的凝集の関数を呼び出すだけにとどめてください。これにより、ライフサイクル管理の関数が、機能的に近い処理が異なる場所に分割される問題を緩和できます。
    *   論理的凝集（Logical Cohesion）の回避:
        *   フラグや引数によって処理を切り替える論理的凝集は極力避けてください。これは、異なるユースケースが似た処理を持つために、安易なDRY（Don't Repeat Yourself）原則の適用により発生しがちです。
        *   論理的凝集の関数は、他のユースケースへの影響が大きくなり、変更時のバグ発生リスクを高め、影響範囲の理解を困難にします。
        *   回避策: 複数のユースケースに対応する共通関数を作成するのではなく、ユースケースごとに関数を定義してください。例えば、チャットのメッセージ送信でテキストとスタンプがある場合、`sendText`と`sendStamp`のようにユースケースで関数を分割します。共通する詳細な実装は、機能的凝集のヘルパー関数として分離し、各ユースケース関数から呼び出す形にしてください。これにより、ユースケースを表現するレイヤーから条件分岐が消え、可読性が大幅に向上し、各ユースケースが単一責任を持つことになります。
    *   偶発的凝集（Coincidental Cohesion）の回避: 関連性のない処理を一つの関数にまとめないでください。これは最も悪い凝集度です。

2.  結合度（Coupling）の最小化:
    *   低い結合度を目指す: 関数間の結合度は可能な限り低く保つように設計してください。
    *   推奨される結合度:
        *   メッセージ結合（Message Coupling）: 関数の実行のみによる結合（値の受け渡しは存在しない）。これは最良の結合度です。
        *   データ結合（Data Coupling）: スカラー値の受け渡しによる結合。
        *   スタンプ結合（Stamp Coupling）: 構造体やクラスの受け渡しによる結合。
    *   極力避けるべき結合度:
        *   制御結合（Control Coupling）: 利用側が利用される側の操作をフラグで指示する結合。これは論理的凝集と密接に関連しており、論理的凝集を避けることで自然と制御結合も回避できます。
        *   共通結合（Common Coupling）/外部結合（External Coupling）: 共通のグローバル変数やpublic変数による結合。
        *   内容結合（Content Coupling）: 他の関数と外部宣言されていない値で結合されている状態（例: 特定のアドレスの値を直接変更する）。これは最も悪い結合度です。
        *   これらの結合度は、コードの独立性と再利用性を著しく損なうため避けてください。

3.  設計の基礎原則の適用:
    *   上記の凝集度と結合度の原則は、以下の普遍的な設計原則に基づいています。これらも意識してコードを生成してください。
        *   関心ごとの分離（Separation of Concerns）
        *   単一責任（Single Responsibility Principle）
        *   抽象度の統一（Unified Abstraction Level）

4.  設計選択の理由付け:
    *   もし、理想とされる機能的凝集や低い結合度から意図的に逸脱する設計（例: 時間的凝集を選択する場合）を行う場合は、なぜその設計を選んだのか、その合理的な理由とトレードオフを明確に説明してください。これにより、生成されたコードの設計意図が明確になり、レビューや将来の改修に役立ちます。